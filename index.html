<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Check-list Di√°rio - LEFE</title>
    <style>
        :root {
            --primary-color: #d90000;
            --primary-dark: #b80000;
            --secondary-color: #0056b3;
            --secondary-dark: #004494;
            --light-gray: #f4f4f4;
            --medium-gray: #ccc;
            --dark-gray: #333;
            --success: #4CAF50;
            --warning: #ff9800;
            --danger: #f44336;
        }
        
        body {
            font-family: Arial, sans-serif;
            background-color: var(--light-gray);
            color: var(--dark-gray);
            margin: 5px;
            line-height: 1.6;
        }
        .container {
            max-width: 900px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1, h2 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 5px;
        }
        h1 {
            font-size: 24px;
            text-align: center;
        }
        h2 {
            font-size: 18px;
            margin-top: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        th, td {
            padding: 8px;
            border: 1px solid var(--medium-gray);
            text-align: left;
        }
        th {
            background-color: #f0f0f0;
        }
        input[type="text"], input[type="date"], input[type="time"], input[type="number"], select, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--medium-gray);
            border-radius: 4px;
            box-sizing: border-box;
        }
        td input, td select {
            width: auto;
        }
        .signature {
            margin-top: 15px;
        }
        .footer {
            margin-top: 15px;
            font-size: 12px;
            text-align: center;
            color: #666;
        }
        /* Toolbar e bot√µes */
        .toolbar {
            position: sticky;
            top: 0;
            z-index: 999;
            background: var(--light-gray);
            padding: 10px 0;
            max-width: 900px;
            margin: 0 auto 5px;
            text-align: right;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: flex-end;
            border-radius: 5px;
        }
        .toolbar button {
            color: #fff;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.10);
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .btn-print {
            background: var(--primary-color);
        }
        .btn-print:hover {
            background: var(--primary-dark);
        }
        .btn-email {
            background: var(--secondary-color);
        }
        .btn-email:hover {
            background: var(--secondary-dark);
        }
        .btn-save {
            background: var(--success);
        }
        .btn-save:hover {
            background: #3d8b40;
        }
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            display: none;
            z-index: 1000;
            max-width: 300px;
            font-size: 16px;
        }
        .notification.success { background: var(--success); color: white; }
        .notification.error { background: var(--danger); color: white; }
        .notification.warning { background: var(--warning); color: white; }
        .notification.info { background: var(--secondary-color); color: white; }

        .required-field {
            border: 2px solid var(--primary-color) !important;
            background-color: #fff2f2;
        }
        
        /* Novos estilos para melhorias */
        .status-counters {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
            flex-wrap: wrap;
            gap: 10px;
        }
        .status-counter {
            padding: 10px;
            border-radius: 5px;
            color: white;
            font-weight: bold;
            text-align: center;
            min-width: 120px;
        }
        .status-ok { background-color: var(--success); }
        .status-ruim { background-color: var(--warning); }
        .status-quebrado { background-color: #ff5722; }
        .status-faltando { background-color: #9c27b0; }
        .status-parar { background-color: var(--danger); }
        
        .search-box {
            margin: 15px 0;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 5px;
            border: 1px solid var(--medium-gray);
        }
        .search-box input {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--medium-gray);
            border-radius: 4px;
        }
        
        .critical-item {
            background-color: #fff2f2 !important;
            font-weight: bold;
        }
        
        .item-highlight {
            animation: highlight 2s ease;
            background-color: #ffffd0;
        }
        
        @keyframes highlight {
            0% { background-color: #ffffd0; }
            100% { background-color: transparent; }
        }
        
        .save-indicator {
            font-size: 12px;
            color: #666;
            margin-left: 10px;
            font-style: italic;
        }
        
        .mobile-optimized select, .mobile-optimized input[type="text"] {
            font-size: 16px; /* Previne zoom no iOS */
        }
        
        @media (max-width: 768px) {
            .toolbar {
                flex-direction: column;
                align-items: stretch;
            }
            .toolbar button {
                width: 100%;
                justify-content: center;
            }
            .status-counters {
                flex-direction: column;
            }
        }
        
        @media print {
            .no-print, .no-print * {
                display: none !important;
            }
            body, .container {
                margin: 0;
                padding: 0;
                box-shadow: none;
                border-radius: 0;
            }
            .status-counters, .search-box {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Barra de ferramentas flutuante -->
    <div class="toolbar no-print">
        <button class="btn-print" onclick="window.print()"><span>üñ®Ô∏è</span> Imprimir</button>
        <button class="btn-email" onclick="enviarPorEmail()"><span>‚úâÔ∏è</span> Enviar por E-mail</button>
        <button class="btn-save" onclick="salvarDados()"><span>üíæ</span> Salvar Agora</button>
        <span id="saveIndicator" class="save-indicator"></span>
    </div>
    
    <div class="container">
        <h1>üöë LEFE - SERVI√áO DE EMERG√äNCIAS M√âDICAS</h1>
        <h2> üìã CHECK-LIST DI√ÅRIO DE INSPE√á√ÉO VEICULAR E EQUIPAMENTOS</h2>
        
        <div class="search-box no-print">
            <input type="text" id="searchInput" placeholder="Buscar item...">
        </div>
        
        <div class="status-counters no-print">
            <div class="status-counter status-ok">‚úÖ OK: <span id="count-ok">0</span></div>
            <div class="status-counter status-ruim">‚ö†Ô∏è Ruim: <span id="count-ruim">0</span></div>
            <div class="status-counter status-quebrado">üõ†Ô∏è Quebrado: <span id="count-quebrado">0</span></div>
            <div class="status-counter status-faltando">‚ùå Faltando: <span id="count-faltando">0</span></div>
            <div class="status-counter status-parar">üö® Parar VTR: <span id="count-parar">0</span></div>
        </div>
        
        <table>
            <tr><td><strong>Hospital:</strong></td><td><input type="text" id="hospital" placeholder="Hospital Raimundo Lima"></td></tr>
            <tr><td><strong>Data:</strong></td><td><input type="date" id="data"></td></tr>
            <tr><td><strong>Hor√°rio de Entrada:</strong></td><td><input type="time" id="horarioEntrada" value="07:00"></td></tr>
            <tr><td><strong>Hor√°rio de Sa√≠da:</strong></td><td><input type="time" id="horarioSaida" value="19:00"></td></tr>
            <tr><td><strong>Condutor de Plant√£o:</strong></td><td><input type="text" id="condutorPlantao" placeholder="Nome completo"></td></tr>
            <tr><td><strong>Recebendo de:</strong></td><td><input type="text" id="recebendoDe" placeholder="Nome do condutor anterior"></td></tr>
        </table>
        
        <h2>üöë DADOS DA VIATURA (USA)</h2>
        <table>
            <tr><th>Item</th><th>Informa√ß√£o</th></tr>
            <tr><td><strong>Placa</strong></td><td><input type="text" id="placa" placeholder="Ex: RKU1F52"></td></tr>
            <tr><td><strong>Km Atual</strong></td><td><input type="number" id="kmAtual" placeholder="Ex: 337847"></td></tr>
            <tr><td><strong>N√≠vel de Combust√≠vel</strong></td><td><input type="text" id="nivelCombustivel" placeholder="Ex: 5/10 tra√ßos ou 1/2 tanque"></td></tr>
            <tr><td><strong>CRV V√°lido at√©</strong></td><td><input type="number" id="crvValido" placeholder="Ano (ex: 2024)"></td></tr>
            <tr><td><strong>Pr√≥xima Troca de √ìleo km</strong></td><td><input type="number" id="proximaTrocaOleo" placeholder="Km da pr√≥xima troca"></td></tr>
            <tr>
                <td><strong>Cart√£o de Abastecimento</strong></td>
                <td>
                    <input type="radio" id="cartaoDisponivel" name="cartaoStatus" value="Dispon√≠vel"> <label for="cartaoDisponivel">Dispon√≠vel</label>
                    <input type="radio" id="cartaoNaoDisponivel" name="cartaoStatus" value="N√£o Dispon√≠vel"> <label for="cartaoNaoDisponivel">N√£o Dispon√≠vel</label>
                </td>
            </tr>
        </table>
        
        <h2>üõ†Ô∏è STATUS DE INSPE√á√ÉO</h2>
        <p><em>Selecione o status: ‚úÖ OK | ‚ö†Ô∏è Ruim | üõ†Ô∏è Quebrado | ‚ùå Faltando | üö® Parar VTR</em></p>
        <table id="inspection-table">
            <thead>
                <tr><th>#</th><th>Item</th><th>Status</th><th>Observa√ß√£o</th></tr>
            </thead>
            <tbody>
                <!-- Os itens ser√£o gerados via JavaScript -->
            </tbody>
        </table>
        
        <h2>üõ†Ô∏è OBSERVA√á√ïES GERAIS / AVARIAS</h2>
        <textarea id="observacoesAvarias" rows="10" style="width: 100%;"></textarea>
        
        <h2>‚úçÔ∏è ASSINATURAS (PARA IMPRESS√ÉO)</h2>
        <div class="signature">
            <p><strong>Condutor Recebendo o Plant√£o:</strong> _________________________________________</p>
            <p><strong>Condutor Entregando o Plant√£o:</strong> _________________________________________</p>
        </div>

        <div class="footer">
            <p>üìù Documento v√°lido como registro de inspe√ß√£o di√°ria ‚Äì LEFE<br>
            üóÇÔ∏è Arquivar ap√≥s preenchimento.<br>‚è≥ Atualizado em 2025.</p>
        </div>
    </div>
    
    <!-- Notifica√ß√£o -->
    <div id="notification" class="notification"></div>
    
    <script>
        // Lista de todos os itens do checklist com identifica√ß√£o de itens cr√≠ticos
        const inspectionItems = [
            { name: "√ìleo do motor", critical: true },
            { name: "√ìleo hidr√°ulico (caixa de dire√ß√£o)", critical: true },
            { name: "Fluido do radiador", critical: true },
            { name: "Fluido de freio", critical: true },  <!-- NOVO ITEM ADICIONADO AQUI -->
            { name: "√Ågua do limpador de para-brisa", critical: false },
            { name: "Correia do alternador", critical: true },
            { name: "Correia dentada do motor", critical: true },
            { name: "Retrovisores", critical: true },
            { name: "Para-brisa", critical: true },
            { name: "Caixa de marchas", critical: true },
            { name: "Pisca dos retrovisores", critical: false },
            { name: "Far√≥is dianteiros", critical: true },
            { name: "Lanternas traseiras", critical: true },
            { name: "Buzina e pisca de alerta", critical: false },
            { name: "Bot√µes dos vidros el√©tricos", critical: false },
            { name: "Travamento das portas", critical: true },
            { name: "Sinalizadores de emerg√™ncia", critical: true },
            { name: "Sirene", critical: true },
            { name: "Luzes internas", critical: false },
            { name: "Farol de embarque", critical: false },
            { name: "Freio de estacionamento", critical: true },
            { name: "Pastilhas de freio (dianteira/traseira)", critical: true },
            { name: "Pneus", critical: true },
            { name: "Macaco, chave de roda, tri√¢ngulo", critical: true },
            { name: "Limpadores/palhetas do para-brisa", critical: true },
            { name: "Limpeza interna", critical: false },
            { name: "Limpeza externa", critical: false },
            { name: "Ar condicionado (dianteiro)", critical: false },
            { name: "Ar condicionado (traseiro)", critical: false },
            { name: "Extintor de inc√™ndio", critical: true },
            { name: "Alarme de estacionamento", critical: false },
            { name: "Alinhamento/Balanceamento", critical: false },
            { name: "Cilindro de oxig√™nio fixo (01)", critical: true },
            { name: "Cintos de seguran√ßa", critical: true },
            { name: "Maca e cinto de seguran√ßa", critical: true },
            { name: "Cadeira de rodas (se aplic√°vel)", critical: false },
            { name: "Prancha/Escada", critical: false },
            { name: "Bateria, inversor, transformador", critical: true },
            { name: "Bancos e capas", critical: false },
            { name: "Pintura/Plotagem", critical: false },
            { name: "C√¢mera de r√© (se aplic√°vel)", critical: false },
            { name: "Chave de troca de oxig√™nio", critical: true },
            { name: "Bala de oxig√™nio port√°til", critical: true },
            { name: "Desfibrilador", critical: true },
            { name: "Monitor", critical: true },
            { name: "Respirador", critical: true },
            { name: "Ox√≠metro", critical: true },
            { name: "Term√¥metro", critical: true },
            { name: "Glicos√≠metro", critical: true },
            { name: "Bolsa de medica√ß√£o", critical: true },
            { name: "Bolsa de entuba√ß√£o", critical: true },
            { name: "Bolsa de ventila√ß√£o", critical: true },
            { name: "Bolsa via a√©rea", critical: true },
            { name: "Arm√°rio do sal√£o", critical: false },
            { name: "Gavetas do sal√£o", critical: false },
            { name: "Ba√∫ do sal√£o", critical: false },
            { name: "Painel de controle do sal√£o", critical: true }
        ];

        // Vari√°veis globais
        let autoSaveInterval;
        let lastSaveTime = null;

        // Fun√ß√£o para gerar a tabela de inspe√ß√£o dinamicamente
        function generateInspectionTable() {
            const tableBody = document.querySelector("#inspection-table tbody");
            const statusOptions = `
                <option value=""></option>
                <option value="‚úÖ OK">‚úÖ OK</option>
                <option value="‚ö†Ô∏è Ruim">‚ö†Ô∏è Ruim</option>
                <option value="üõ†Ô∏è Quebrado">üõ†Ô∏è Quebrado</option>
                <option value="‚ùå Faltando">‚ùå Faltando</option>
                <option value="üö® Parar VTR">üö® Parar VTR</option>
            `;
            
            inspectionItems.forEach((item, index) => {
                const row = document.createElement('tr');
                if (item.critical) {
                    row.classList.add('critical-item');
                }
                row.innerHTML = `
                    <td>${(index + 1).toString().padStart(2, '0')}</td>
                    <td>${item.name}</td>
                    <td><select id="status-${index + 1}" class="status-select">${statusOptions}</select></td>
                    <td><input type="text" id="obs-${index + 1}" style="width: 100%;" class="obs-input"></td>
                `;
                tableBody.appendChild(row);
            });

            // Adicionar event listeners para os selects e inputs
            document.querySelectorAll('.status-select').forEach(select => {
                select.addEventListener('change', updateStatusCounters);
            });
            
            document.querySelectorAll('.obs-input').forEach(input => {
                input.addEventListener('input', debounce(salvarDados, 1000));
            });
        }

        // Fun√ß√£o para atualizar os contadores de status
        function updateStatusCounters() {
            const counters = {
                '‚úÖ OK': 0,
                '‚ö†Ô∏è Ruim': 0,
                'üõ†Ô∏è Quebrado': 0,
                '‚ùå Faltando': 0,
                'üö® Parar VTR': 0
            };
            
            document.querySelectorAll('.status-select').forEach(select => {
                if (select.value && counters.hasOwnProperty(select.value)) {
                    counters[select.value]++;
                }
            });
            
            document.getElementById('count-ok').textContent = counters['‚úÖ OK'];
            document.getElementById('count-ruim').textContent = counters['‚ö†Ô∏è Ruim'];
            document.getElementById('count-quebrado').textContent = counters['üõ†Ô∏è Quebrado'];
            document.getElementById('count-faltando').textContent = counters['‚ùå Faltando'];
            document.getElementById('count-parar').textContent = counters['üö® Parar VTR'];
        }

        // Fun√ß√£o para buscar itens na tabela
        function setupSearch() {
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', debounce(function() {
                const searchText = this.value.toLowerCase();
                const rows = document.querySelectorAll('#inspection-table tbody tr');
                
                rows.forEach((row, index) => {
                    const itemName = inspectionItems[index].name.toLowerCase();
                    if (itemName.includes(searchText)) {
                        row.style.display = '';
                        row.classList.add('item-highlight');
                        setTimeout(() => {
                            row.classList.remove('item-highlight');
                        }, 2000);
                    } else {
                        row.style.display = 'none';
                    }
                });
            }, 300));
        }

        // Fun√ß√£o debounce para melhorar performance
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Fun√ß√£o para salvar dados no localStorage
        function salvarDados() {
            try {
                const dados = {
                    hospital: document.getElementById("hospital").value,
                    data: document.getElementById("data").value,
                    horarioEntrada: document.getElementById("horarioEntrada").value,
                    horarioSaida: document.getElementById("horarioSaida").value,
                    condutorPlantao: document.getElementById("condutorPlantao").value,
                    recebendoDe: document.getElementById("recebendoDe").value,
                    placa: document.getElementById("placa").value,
                    kmAtual: document.getElementById("kmAtual").value,
                    nivelCombustivel: document.getElementById("nivelCombustivel").value,
                    crvValido: document.getElementById("crvValido").value,
                    proximaTrocaOleo: document.getElementById("proximaTrocaOleo").value,
                    cartaoStatus: document.querySelector('input[name="cartaoStatus"]:checked')?.value,
                    observacoesAvarias: document.getElementById("observacoesAvarias").value,
                    itens: []
                };
                
                // Salvar status e observa√ß√µes de cada item
                for (let i = 1; i <= inspectionItems.length; i++) {
                    dados.itens.push({
                        status: document.getElementById(`status-${i}`).value,
                        obs: document.getElementById(`obs-${i}`).value
                    });
                }
                
                localStorage.setItem('checklistLEFE', JSON.stringify(dados));
                lastSaveTime = new Date();
                document.getElementById('saveIndicator').textContent = `√öltimo salvamento: ${lastSaveTime.toLocaleTimeString()}`;
                
                return true;
            } catch (e) {
                console.error("Erro ao salvar dados:", e);
                showNotification("Erro ao salvar dados localmente.", "error");
                return false;
            }
        }

        // Fun√ß√£o para carregar dados do localStorage
        function carregarDados() {
            try {
                const dadosSalvos = localStorage.getItem('checklistLEFE');
                if (!dadosSalvos) return false;
                
                const dados = JSON.parse(dadosSalvos);
                
                // Preencher campos b√°sicos
                document.getElementById("hospital").value = dados.hospital || '';
                document.getElementById("data").value = dados.data || '';
                document.getElementById("horarioEntrada").value = dados.horarioEntrada || '';
                document.getElementById("horarioSaida").value = dados.horarioSaida || '';
                document.getElementById("condutorPlantao").value = dados.condutorPlantao || '';
                document.getElementById("recebendoDe").value = dados.recebendoDe || '';
                document.getElementById("placa").value = dados.placa || '';
                document.getElementById("kmAtual").value = dados.kmAtual || '';
                document.getElementById("nivelCombustivel").value = dados.nivelCombustivel || '';
                document.getElementById("crvValido").value = dados.crvValido || '';
                document.getElementById("proximaTrocaOleo").value = dados.proximaTrocaOleo || '';
                document.getElementById("observacoesAvarias").value = dados.observacoesAvarias || '';
                
                // Preencher status do cart√£o
                if (dados.cartaoStatus) {
                    document.querySelector(`input[name="cartaoStatus"][value="${dados.cartaoStatus}"]`).checked = true;
                }
                
                // Preencher itens de inspe√ß√£o
                if (dados.itens && dados.itens.length === inspectionItems.length) {
                    for (let i = 0; i < dados.itens.length; i++) {
                        document.getElementById(`status-${i+1}`).value = dados.itens[i].status || '';
                        document.getElementById(`obs-${i+1}`).value = dados.itens[i].obs || '';
                    }
                }
                
                updateStatusCounters();
                showNotification("Dados anteriores carregados com sucesso.", "success");
                return true;
            } catch (e) {
                console.error("Erro ao carregar dados:", e);
                return false;
            }
        }

        // Fun√ß√£o para validar campos obrigat√≥rios
        function validateForm() {
            const requiredFields = [
                { id: "hospital", name: "Hospital" },
                { id: "data", name: "Data" },
                { id: "condutorPlantao", name: "Condutor de Plant√£o" },
                { id: "placa", name: "Placa" },
                { id: "kmAtual", name: "Km Atual" }
            ];
            
            let isValid = true;
            let missingFields = [];
            
            // Limpa formata√ß√£o anterior
            document.querySelectorAll('.required-field').forEach(el => el.classList.remove('required-field'));
            
            requiredFields.forEach(field => {
                const element = document.getElementById(field.id);
                if (!element.value.trim()) {
                    isValid = false;
                    missingFields.push(field.name);
                    element.classList.add("required-field");
                }
            });
            
            // Verificar se h√° itens cr√≠ticos com problemas
            const criticalIssues = [];
            inspectionItems.forEach((item, index) => {
                if (item.critical) {
                    const status = document.getElementById(`status-${index+1}`).value;
                    if (status && status !== "‚úÖ OK") {
                        criticalIssues.push(item.name);
                    }
                }
            });
            
            if (criticalIssues.length > 0) {
                showNotification(`Aten√ß√£o: Itens cr√≠ticos com problemas: ${criticalIssues.join(", ")}`, "warning");
            }
            
            if (!isValid) {
                showNotification("Por favor, preencha os campos obrigat√≥rios: " + missingFields.join(", "), "error");
            }
            
            return isValid;
        }
        
        // Fun√ß√£o para enviar por email usando mailto:
        function enviarPorEmail() {
            if (!validateForm()) {
                return;
            }
            
            // --- COLETA DE DADOS ---
            const dadosCabecalho = {
                hospital: document.getElementById("hospital").value,
                data: new Date(document.getElementById("data").value).toLocaleDateString('pt-BR', { timeZone: 'UTC' }),
                horarioEntrada: document.getElementById("horarioEntrada").value,
                horarioSaida: document.getElementById("horarioSaida").value,
                condutorPlantao: document.getElementById("condutorPlantao").value,
                recebendoDe: document.getElementById("recebendoDe").value
            };
            
            const dadosViatura = {
                placa: document.getElementById("placa").value.toUpperCase(),
                kmAtual: document.getElementById("kmAtual").value,
                nivelCombustivel: document.getElementById("nivelCombustivel").value,
                crvValido: document.getElementById("crvValido").value,
                proximaTrocaOleo: document.getElementById("proximaTrocaOleo").value,
                cartaoStatus: document.querySelector('input[name="cartaoStatus"]:checked')?.value || 'N√£o informado'
            };
            
            const itensInspecao = [];
            for (let i = 1; i <= inspectionItems.length; i++) {
                const status = document.getElementById(`status-${i}`).value;
                const obs = document.getElementById(`obs-${i}`).value.trim();
                if (status || obs) {
                    itensInspecao.push({
                        num: i.toString().padStart(2, '0'),
                        item: inspectionItems[i-1].name,
                        status: status || 'N√£o avaliado',
                        obs: obs || '---'
                    });
                }
            }

            if (itensInspecao.length === 0) {
                showNotification("Nenhum item de inspe√ß√£o foi preenchido. Preencha ao menos um status.", "warning");
                return;
            }

            const observacoesGerais = document.getElementById("observacoesAvarias").value;
            
            // --- MONTAGEM DO CORPO DO E-MAIL (HTML) ---
            let corpoEmail = `
                <div style="font-family: Arial, sans-serif; font-size: 14px;">
                    <h2 style="color: #d90000;">Check-list Di√°rio - Viatura ${dadosViatura.placa}</h2>
                    <p><strong>Hospital:</strong> ${dadosCabecalho.hospital}<br>
                    <strong>Condutor de Plant√£o:</strong> ${dadosCabecalho.condutorPlantao}<br>
                    <strong>Data:</strong> ${dadosCabecalho.data}<br>
                    <strong>Hor√°rio de Entrada:</strong> ${dadosCabecalho.horarioEntrada}<br>
                    <strong>Hor√°rio de Sa√≠da:</strong> ${dadosCabecalho.horarioSaida}</p>
                    <h3 style="color: #333;">Dados da Viatura</h3>
                    <table border="1" cellpadding="5" cellspacing="0" style="width:100%; border-collapse: collapse;">
                        <tr><td style="background-color: #f0f0f0;"><strong>Placa:</strong></td><td>${dadosViatura.placa}</td></tr>
                        <tr><td style="background-color: #f0f0f0;"><strong>Km Atual:</strong></td><td>${dadosViatura.kmAtual} km</td></tr>
                        <tr><td style="background-color: #f0f0f0;"><strong>N√≠vel Combust√≠vel:</strong></td><td>${dadosViatura.nivelCombustivel}</td></tr>
                        <tr><td style="background-color: #f0f0f0;"><strong>Cart√£o Abastecimento:</strong></td><td>${dadosViatura.cartaoStatus}</td></tr>
                    </table>

                    <h3 style="color: #333; margin-top: 20px;">Itens de Inspe√ß√£o com Observa√ß√µes</h3>
                    <table border="1" cellpadding="5" cellspacing="0" style="width:100%; border-collapse: collapse;">
                        <tr style="background-color: #f0f0f0;">
                            <th>#</th>
                            <th>Item</th>
                            <th>Status</th>
                            <th>Observa√ß√£o</th>
                        </tr>
                        ${itensInspecao.map(item => `
                            <tr>
                                <td>${item.num}</td>
                                <td>${item.item}</td>
                                <td>${item.status}</td>
                                <td>${item.obs}</td>
                            </tr>
                        `).join('')}
                    </table>
                    
                    ${observacoesGerais ? `
                        <h3 style="color: #333; margin-top: 20px;">Observa√ß√µes Gerais / Avarias</h3>
                        <p style="white-space: pre-wrap; border: 1px solid #ccc; padding: 10px; background-color: #f9f9f9;">${observacoesGerais}</p>
                    ` : ''}

                    <p style="margin-top: 20px; font-size: 12px; color: #666;">E-mail gerado automaticamente pelo sistema de Check-list LEFE.</p>
                </div>
            `;
            
            // --- CRIA√á√ÉO DO LINK mailto: ---
            const para = "email_destinatario@sua_empresa.com"; // <-- TROQUE PELO E-MAIL DE DESTINO
            const assunto = `Check-list Viatura ${dadosViatura.placa} - ${dadosCabecalho.data}`;
            
            // encodeURIComponent √© crucial para garantir que caracteres especiais n√£o quebrem o link
            const mailtoLink = `mailto:${para}?subject=${encodeURIComponent(assunto)}&body=${encodeURIComponent(corpoEmail)}`;
            
            // Abre o cliente de e-mail do usu√°rio
            window.location.href = mailtoLink;

            showNotification("Preparando e-mail... Verifique seu programa de e-mail.", "success");
        }
        
        // Fun√ß√£o para mostrar notifica√ß√µes
        function showNotification(message, type) {
            const notification = document.getElementById("notification");
            notification.textContent = message;
            notification.className = "notification " + type;
            notification.style.display = "block";
            
            setTimeout(() => {
                notification.style.display = "none";
            }, 6000);
        }

        // Inicializa√ß√£o quando a p√°gina carrega
        document.addEventListener('DOMContentLoaded', function() {
            // Definir data atual ao carregar a p√°gina
            document.getElementById("data").value = new Date().toISOString().split("T")[0];
            
            // Gerar a tabela
            generateInspectionTable();
            
            // Configurar busca
            setupSearch();
            
            // Tentar carregar dados salvos
            if (carregarDados()) {
                showNotification("Dados anteriores carregados.", "info");
            }
            
            // Configurar auto-salvamento
            autoSaveInterval = setInterval(salvarDados, 30000); // Salva a cada 30 segundos
            
            // Adicionar event listeners para campos de entrada
            const inputFields = document.querySelectorAll('input, select, textarea');
            inputFields.forEach(field => {
                field.addEventListener('input', debounce(salvarDados, 1000));
            });
            
            // Adicionar listener para salvar antes de sair da p√°gina
            window.addEventListener('beforeunload', function(e) {
                salvarDados();
            });r
        });
    </script>
</body>
</html>
